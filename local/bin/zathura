#!/bin/bash

/usr/bin/zathura "$@" & disown
pid="$!"

list_window() {
  wmctrl -l -p | tr -s ' ' | cut -f 1,3 -d ' '
}


if [ -n "$DISPLAY" ]; then
  attempt=0
  max_attempt=50
  while ! list_window | grep -w "$pid" >/dev/null; do
    sleep 0.01
    attempt=$((attempt+1))
    if [[ $attempt -gt $max_attempt ]]; then
      exit
    fi
  done
  wid=$(list_window | grep -w "$pid" | cut -f 1 -d ' ')
  /usr/bin/wmctrl -a "$wid" -i
fi
